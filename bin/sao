#!/usr/bin/env node
'use strict'
const cac = require('cac')
const ora = require('ora')
const update = require('update-notifier')

const cli = cac()

cli.command('*', 'Generate a new project', (input, flags) => {
  const template = input[0]
  if (!template) {
    return cli.showHelp()
  }

  const sao = require('../lib')
  const event = require('../lib/event')

  const spinner = ora()
  event.on('download:start', () => {
    spinner.text = 'Downloading...'
    spinner.start()
  })
  event.on('download:stop', () => {
    spinner.stop()
  })

  const options = Object.assign({
    template,
    targetFolder: input[1]
  }, flags)

  return sao(options)
    .catch(err => {
      spinner.stop()
      console.log(err.stack)
    })
})

cli
  .option('c, config', 'Use custom config file')
  .option('git-cache', 'Use cached version for a repo template')

cli.parse()

update({pkg: cli.pkg}).notify()
